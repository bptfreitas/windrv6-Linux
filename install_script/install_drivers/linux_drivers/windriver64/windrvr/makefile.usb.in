# Jungo Confidential. Copyright (c) 2011 Jungo Ltd.  http://www.jungo.com
# Template file for configure script

ifneq ($(KERNELRELEASE),)

obj-m  := @MODULE_NAME@.o
@MODULE_NAME@-y := wdusb_linux.o

ccflags-y := @CFLAGS@ @EXTRA_CFLAGS@

ccflags-remove-y := -pg

else

CSRCS = @CSRCS@ 
OD = @OD@
MODDIR = @MODDIR@
MODULE_NAME = @MODULE_NAME@
TARGET = @TARGET@
CFLAGS = @CFLAGS@
EXTRA_CFLAGS = @EXTRA_CFLAGS@
LDFLAGS = @LDFLAGS@
ROOT_DIR = @ROOT_DIR@

KDIR ?= /lib/modules/`uname -r`/build

ifeq ($(DEBUG),1)
	CFLAGS += -g -DDEBUG
endif

# COBJS = $(patsubst %.c,$(OD)/%.o,$(CSRCS))

all: modules

modules:	
	ln -f -s makefile.usb Makefile 
	make -C $(KDIR) M=$$PWD modules

modpost:
	@MODPOST_RULE@
	@MODPOST_CC_RULE@
	
clean:
	@CLEAN_RULE@
	
endif

